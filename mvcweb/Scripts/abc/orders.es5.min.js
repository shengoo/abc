"use strict";$(function(){var n=$(".orderform"),i=$(".tab li",n),t;webAbc.ajax({url:"getorders",success:function(n){window.orders=n;i.eq(0).click()}});i.on("click",function(i){var f=$(i.target),r=f.attr("data"),e=[],u;t&&t.removeClass("active");t=f;t.addClass("active");window.orders&&window.orders.forEach(function(n){(r=="0"||!n.TradeNo&&r=="1"||n.TradeNo&&r=="2")&&e.push(n)});u=function(n){var i="",r=n[0],u=0,t;for(i+='<div class="order-item" style="height:'+(40+32*n.length)+'px"><div class="order-item-title"><div class="date">'+webAbc.dateParseString(new Date(parseInt(r.OrderTime.substr(6))),!0,!0)+'<\/div><div class="no">订单号：<\/div><div class="trade">'+r.No+'<\/div><\/div><table class="order-body" >';n.length>0;)t=n.shift(),i+='<tr><td class="order-body-name" >'+t.CardName+'<\/td><td class="order-body-category" >'+t.Category+'<\/td><td class="order-body-name" >'+t.CourseName+'<\/td><td class="order-body-price" >'+t.Amount+'<\/td><td class="order-body-qty" >'+t.Qty+"<\/td><\/tr>",u+=t.Price;return i+('<\/table><div class="order-item-total">'+u+'<\/div><div class="order-item-operation">'+(r.TradeNo?'<a class="operation btn" action="nothing" disabled>已完成<\/a>':'<a class="operation btn" data="'+t.No+'" action="zhifu">支付<\/a><a class="operation btn" data="'+t.No+'" action="quxiao">取消<\/a>')+"<\/div><\/div>")};webAbc.getPageSetting($(".page",n),e,8,function(t){var r="",i=[];t.forEach(function(n){i.length==0||i[0].No==n.No?i.push(n):(r+=u(i),i.push(n))});r+=i.length>0?u(i):"";$(".order-list",n).html(r);webAbc.autoAjustIframeHeight();$("a[action]",n).click(function(){var n=$(this),t=n.attr("action"),i=n.attr("data");t=="zhifu"?window.location.href=$.url+"/BuyClass/BuyCarSubmit?orderNo="+i:t=="quxiao"&&$.ajax({url:$.url+"/Member/cancelorder",type:"post",dataType:"json",data:{orderNo:i},success:function(n){n.IsSuccess?(webAbc.showMessage(1,"订单取消成功！"),member.myOrderReady()):webAbc.showMessage(2,n.ErrMsg)}})})})})});